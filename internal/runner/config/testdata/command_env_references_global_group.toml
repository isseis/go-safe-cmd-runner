# Integration test: Command.Env with Global/Group vars reference
# This test validates:
# - Command.Env can reference internal variables from Global/Group
# - Cmd can reference internal variables
# - Args can reference internal variables
# - Variable priority: Command vars > Group vars > Global vars
# - New system: vars (internal variables) and %{VAR} syntax

[global]
env_vars = ["BASE_DIR=%{base_dir}"]
env_allowed = ["HOME", "PATH"]

[global.vars]
base_dir = "/opt"

[[groups]]
name = "app_group"
env_vars = ["APP_DIR=%{app_dir}"]

[groups.vars]
app_dir = "%{base_dir}/myapp"

[[groups.commands]]
name = "run_app"
cmd = "%{app_dir}/bin/server"
args = ["--log", "%{log_dir}/app.log"]
env_vars = ["LOG_DIR=%{log_dir}"]

[groups.commands.vars]
log_dir = "%{app_dir}/logs"

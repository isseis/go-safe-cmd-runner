# Group.Env Integration Test
# This TOML file tests Global.Env and Group.Env functionality with allowlist inheritance

version = "1.0"

[global]
env_vars = ["BASE_DIR=%{base_dir}", "LOG_LEVEL=info"]
env_allowed = ["HOME", "PATH", "USER"]

[global.vars]
base_dir = "/opt"

[[groups]]
name = "inherit_group"
# env_allowlist is not defined â†’ should inherit from global allowlist
env_vars = ["APP_DIR=%{app_dir}"]
verify_files = ["%{app_dir}/verify.sh"]

[groups.vars]
app_dir = "%{base_dir}/app"

[[groups.commands]]
name = "test_cmd"
cmd = "/bin/echo"
args = ["%{app_dir}"]

[[groups]]
name = "override_group"
env_allowed = ["USER"]  # Override global allowlist
env_vars = ["DATA_DIR=%{data_dir}"]
verify_files = ["%{data_dir}/verify.sh"]

[groups.vars]
data_dir = "/data"

[[groups.commands]]
name = "test_cmd"
cmd = "/bin/echo"
args = ["%{data_dir}"]

[[groups]]
name = "reject_group"
env_allowed = []  # Empty slice should reject all system environment variables
env_vars = ["STATIC_DIR=%{static_dir}"]
verify_files = ["%{static_dir}/verify.sh"]

[groups.vars]
static_dir = "/static"

[[groups.commands]]
name = "test_cmd"
cmd = "/bin/echo"
args = ["%{static_dir}"]

# Group.Env Integration Test
# This TOML file tests Global.Env and Group.Env functionality with allowlist inheritance

version = "1.0"

[global]
vars = ["base_dir=/opt"]
env_vars = ["BASE_DIR=%{base_dir}", "LOG_LEVEL=info"]
env_allowed = ["HOME", "PATH", "USER"]

[[groups]]
name = "inherit_group"
# env_allowlist is not defined â†’ should inherit from global allowlist
vars = ["app_dir=%{base_dir}/app"]
env_vars = ["APP_DIR=%{app_dir}"]
verify_files = ["%{app_dir}/verify.sh"]

[[groups.commands]]
name = "test_cmd"
cmd = "/bin/echo"
args = ["%{app_dir}"]

[[groups]]
name = "override_group"
env_allowed = ["USER"]  # Override global allowlist
vars = ["data_dir=/data"]
env_vars = ["DATA_DIR=%{data_dir}"]
verify_files = ["%{data_dir}/verify.sh"]

[[groups.commands]]
name = "test_cmd"
cmd = "/bin/echo"
args = ["%{data_dir}"]

[[groups]]
name = "reject_group"
env_allowed = []  # Empty slice should reject all system environment variables
vars = ["static_dir=/static"]
env_vars = ["STATIC_DIR=%{static_dir}"]
verify_files = ["%{static_dir}/verify.sh"]

[[groups.commands]]
name = "test_cmd"
cmd = "/bin/echo"
args = ["%{static_dir}"]

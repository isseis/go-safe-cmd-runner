# go-safe-cmd-runner TOML設定ファイル ユーザーガイド

go-safe-cmd-runner の TOML 設定ファイルの記述方法を解説する包括的なユーザーガイドです。

## 目次

### 第1章: [はじめに](01_introduction.ja.md)
- 本ドキュメントの目的
- TOML設定ファイルの概要
- 設定ファイルの基本構造

### 第2章: [設定ファイルの階層構造](02_hierarchy.ja.md)
- 階層の概要図
- 三層構造の説明
  - ルートレベル
  - グローバルレベル
  - グループレベル
  - コマンドレベル
- 設定の継承とオーバーライドの仕組み

### 第3章: [ルートレベル設定](03_root_level.ja.md)
- version パラメータ
  - 概要と役割
  - 設定例
  - 注意事項

### 第4章: [グローバルレベル設定](04_global_level.ja.md)
- timeout - タイムアウト設定
- workdir - 作業ディレクトリ
- log_level - ログレベル
- skip_standard_paths - 標準パス検証のスキップ
- env_allowlist - 環境変数許可リスト
- verify_files - ファイル検証リスト
- max_output_size - 出力サイズ上限

### 第5章: [グループレベル設定](05_group_level.ja.md)
- グループの基本設定
  - name - グループ名
  - description - 説明
  - priority - 優先度
- リソース管理設定
  - temp_dir - 一時ディレクトリ
  - workdir - 作業ディレクトリ
- セキュリティ設定
  - verify_files - ファイル検証
  - env_allowlist - 環境変数許可リスト
- 環境変数継承モード
  - 継承モード (inherit)
  - 明示モード (explicit)
  - 拒否モード (reject)

### 第6章: [コマンドレベル設定](06_command_level.ja.md)
- コマンドの基本設定
  - name - コマンド名
  - description - 説明
  - cmd - 実行コマンド
  - args - 引数
- 環境設定
  - env - 環境変数
- タイムアウト設定
  - timeout - コマンド固有タイムアウト
- 権限管理
  - run_as_user - 実行ユーザー
  - run_as_group - 実行グループ
- リスク管理
  - max_risk_level - 最大リスクレベル
- 出力管理
  - output - 標準出力キャプチャ

### 第7章: [変数展開機能](07_variable_expansion.ja.md)
- 変数展開の概要
- 変数展開の文法
- 使用可能な場所
  - cmd での変数展開
  - args での変数展開
  - 複数変数の組み合わせ
- 実践例
  - コマンドパスの動的構築
  - 引数の動的生成
  - 環境別設定の切り替え
- ネスト変数
- エスケープシーケンス
- セキュリティ考慮事項

### 第8章: [実践的な設定例](08_practical_examples.ja.md)
- 基本的な設定例
- セキュリティを重視した設定例
- リソース管理を含む設定例
- 権限昇格を伴う設定例
- 出力キャプチャを使用した設定例
- 変数展開を活用した設定例
- 複合的な設定例
- リスクベースの制御例

### 第9章: [ベストプラクティス](09_best_practices.ja.md)
- セキュリティのベストプラクティス
- 環境変数管理のベストプラクティス
- グループ構成のベストプラクティス
- エラーハンドリングのベストプラクティス
- 保守性のベストプラクティス
- パフォーマンスのベストプラクティス
- テストとバリデーション
- ドキュメント化

### 第10章: [トラブルシューティング](10_troubleshooting.ja.md)
- よくあるエラーと対処法
- 設定検証方法
- デバッグ手法
- パフォーマンス問題
- よくある質問 (FAQ)

### [付録](appendix.ja.md)
- 付録A: パラメータ一覧表
- 付録B: サンプル設定ファイル集
- 付録C: 用語集
- 付録D: 設定ファイルテンプレート
- 付録E: 参考リンク

## クイックスタート

### 最小構成の例

```toml
version = "1.0"

[[groups]]
name = "hello_world"

[[groups.commands]]
name = "greet"
cmd = "/bin/echo"
args = ["Hello, World!"]
```

### 基本的な使い方

1. **設定ファイルの作成**: `config.toml` ファイルを作成
2. **ハッシュファイルの作成** (必要な場合):
   ```bash
record config.toml /bin/echo
   ```
3. **実行**:
   ```bash
   go-safe-cmd-runner -file config.toml
   ```

## 推奨される学習順序

1. **初心者**: 第1章〜第3章で基本を理解
2. **中級者**: 第4章〜第6章でパラメータを学習
3. **上級者**: 第7章〜第9章で高度な機能とベストプラクティスを習得
4. **トラブル発生時**: 第10章で問題を解決
5. **リファレンス**: 付録を参照

## サンプルファイル

プロジェクトの `sample/` ディレクトリには、様々なユースケースに対応したサンプル設定ファイルが用意されています:

- `sample/comprehensive.toml` - 全機能を網羅した総合例
- `sample/variable_expansion_basic.toml` - 変数展開の基本例
- `sample/output_capture_basic.toml` - 出力キャプチャの基本例
- その他多数のサンプルファイル

## コントリビューション

ドキュメントの改善提案や誤りの指摘は、GitHub Issues または Pull Request でお願いします。

## ライセンス

本ドキュメントは go-safe-cmd-runner プロジェクトの一部として、同じライセンスの下で提供されています。

---

**最終更新**: 2025-10-02
**バージョン**: 1.0

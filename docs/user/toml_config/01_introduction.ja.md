# 第1章: はじめに

## 1.1 本ドキュメントの目的

本ドキュメントは、go-safe-cmd-runner の TOML 設定ファイルの記述方法を解説するユーザーガイドです。設定ファイルの構造、各パラメータの詳細、実践的な使用例を通じて、安全かつ効率的なコマンド実行環境の構築方法を学ぶことができます。

### 対象読者

- go-safe-cmd-runner を使用してバッチ処理やコマンド実行を行うシステム管理者
- セキュアなコマンド実行環境を構築したい開発者
- TOML 設定ファイルの記述方法を習得したいユーザー

## 1.2 TOML設定ファイルの概要

go-safe-cmd-runner は、TOML (Tom's Obvious, Minimal Language) 形式の設定ファイルを使用してコマンドの実行を管理します。TOML は人間が読み書きしやすく、明確な意味を持つ設定ファイル形式です。

### 主な特徴

1. **階層的な構造**: グローバル設定、グループ設定、コマンド設定の3層構造
2. **セキュリティ重視**: ファイル検証、環境変数制御、権限管理などのセキュリティ機能
3. **柔軟な設定**: タイムアウト、作業ディレクトリ、環境変数などの細かな制御
4. **変数展開**: 動的なコマンド構築のための変数展開機能
5. **出力管理**: コマンド出力のキャプチャとファイル保存

## 1.3 設定ファイルの基本構造

TOML 設定ファイルは以下の基本構造を持ちます:

```toml
# バージョン指定(必須)
version = "1.0"

# グローバル設定(オプション)
[global]
timeout = 60
workdir = "/tmp/workspace"
env_allowed = ["PATH", "HOME", "USER"]

# コマンドグループ(1つ以上必須)
[[groups]]
name = "example_group"
description = "サンプルグループの説明"

# グループ内のコマンド(1つ以上必須)
[[groups.commands]]
name = "hello_world"
description = "Hello World を出力"
cmd = "echo"
args = ["Hello, World!"]
```

### 設定の構成要素

1. **ルートレベル**: バージョン情報
2. **グローバルレベル** (`[global]`): 全グループに適用される共通設定
3. **グループレベル** (`[[groups]]`): 関連するコマンドをまとめる単位
4. **コマンドレベル** (`[[groups.commands]]`): 実際に実行するコマンドの定義

各レベルの詳細については、後続の章で説明します。

### 最小構成の例

最もシンプルな設定ファイルは以下のようになります:

```toml
version = "1.0"

[[groups]]
name = "minimal"

[[groups.commands]]
name = "test"
cmd = "echo"
args = ["test"]
```

この例では、バージョン情報、1つのグループ、1つのコマンドのみを定義しています。

## 次のステップ

次章では、設定ファイルの階層構造について詳しく解説し、各レベルがどのように連携するかを学びます。

# Slack Group Notification Test Configuration
# This configuration tests the new group-level Slack notification functionality
# that sends notifications after each command group execution (success or failure)

version = "1.0"

[global]
timeout = 30
verify_standard_paths = false

# Environment variables needed for Slack notifications
# The SLACK_WEBHOOK_URL should be set in the environment before running
env_allowed = [
    "PATH",
    "LANG",
    "SLACK_WEBHOOK_URL",
]

# Group 1: Successful command group
# This should trigger a SUCCESS notification to Slack
[[groups]]
name = "success_group"
description = "Test group that should complete successfully and send success notification"
priority = 1

[[groups.commands]]
name = "hello_world"
description = "Simple echo command that will succeed"
cmd = "echo"
args = ["Hello from success group! This should trigger a success notification."]

[[groups.commands]]
name = "date_command"
description = "Show current date"
cmd = "date"
args = []

# Group 2: Failing command group
# This should trigger an ERROR notification to Slack
[[groups]]
name = "failure_group"
description = "Test group that should fail and send error notification"
priority = 2

[[groups.commands]]
name = "failing_command"
description = "Command that will fail with non-zero exit code"
cmd = "sh"
args = ["-c", "echo 'This command will fail'; exit 1"]

# Group 3: Another successful group to test multiple notifications
[[groups]]
name = "second_success_group"
description = "Another successful group to test multiple notifications"
priority = 3

[[groups.commands]]
name = "multiple_echo"
description = "Multiple echo commands in sequence"
cmd = "echo"
args = ["Group 3 completed successfully! Second success notification test."]

[[groups.commands]]
name = "whoami_command"
description = "Show current user"
cmd = "whoami"
args = []

# Group 4: Mixed commands ending with failure
# This should trigger an ERROR notification since the group fails overall
[[groups]]
name = "mixed_group"
description = "Group with both successful and failing commands"
priority = 4

[[groups.commands]]
name = "initial_success"
description = "First command that succeeds"
cmd = "echo"
args = ["Starting mixed group..."]

[[groups.commands]]
name = "final_failure"
description = "Final command that fails"
cmd = "false"
args = []

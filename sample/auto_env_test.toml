# Automatic internal variables test configuration
# Tests %{__runner_datetime} and %{__runner_pid} auto-generated variables
version = "1.0"

[global]
timeout = 30
log_level = "debug"
verify_standard_paths = false
env_allowed = [
    "PATH",
    "HOME",
    "USER",
]

# Group 1: Basic runner variable expansion with auto internal variables
[[groups]]
name = "basic_auto_env"
description = "Test basic automatic internal variable expansion"
priority = 1

[[groups.commands]]
name = "expand_datetime"
description = "Expand %{__runner_datetime} in args"
cmd = "echo"
args = ["DateTime: %{__runner_datetime}"]

[[groups.commands]]
name = "expand_pid"
description = "Expand %{__runner_pid} in args"
cmd = "echo"
args = ["PID: %{__runner_pid}"]

[[groups.commands]]
name = "expand_both"
description = "Expand both auto variables"
cmd = "echo"
args = ["DateTime=%{__runner_datetime}", "PID=%{__runner_pid}"]

# Group 2: Variable expansion with auto variables and user vars
[[groups]]
name = "combined_expansion"
description = "Test variable expansion combining auto variables with user vars"
priority = 2

[[groups.commands]]
name = "user_and_auto"
description = "Combine auto variables with user vars in expansion"
cmd = "echo"
args = ["User=%{user}, DateTime=%{__runner_datetime}, PID=%{__runner_pid}"]
vars = ["user=testuser"]

[[groups.commands]]
name = "multiple_vars"
description = "Multiple variables in single argument"
cmd = "echo"
args = ["Base: %{base_path}/log-%{__runner_datetime}.txt"]
vars = ["base_path=/var/log"]

# Group 3: File operations with auto variables
[[groups]]
name = "file_operations"
description = "Test file operations using auto internal variables"
priority = 3

[[groups.commands]]
name = "timestamp_filename"
description = "Create filename with timestamp"
cmd = "sh"
args = ["-c", "echo test > /tmp/auto-env-test/file-%{__runner_datetime}.txt && ls -la /tmp/auto-env-test/file-*.txt"]

[[groups.commands]]
name = "pid_filename"
description = "Create filename with PID"
cmd = "sh"
args = ["-c", "echo test > /tmp/auto-env-test/pid-%{__runner_pid}.txt && cat /tmp/auto-env-test/pid-%{__runner_pid}.txt"]

# Group 4: Complex scenarios
[[groups]]
name = "complex_usage"
description = "Test complex usage patterns"
priority = 4

[[groups.commands]]
name = "backup_simulation"
description = "Simulate backup with timestamp"
cmd = "echo"
args = ["tar czf /tmp/backup/data-%{__runner_datetime}.tar.gz /data"]

[[groups.commands]]
name = "log_with_metadata"
description = "Log file with multiple variables"
cmd = "echo"
args = ["Log: %{user}@%{host}-%{__runner_datetime}-%{__runner_pid}.log"]
vars = [
    "user=admin",
    "host=server01"
]
